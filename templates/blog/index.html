{{define "header"}}
    <link rel="stylesheet" href="/static/libs/editormd/css/editormd.css"/>
{{end}}

{{define "content"}}
    <div class="container transparent">
        <div class="row">
            <div class="col-lg-9">
                <div id="category" class="noselect">
                    <div id="category-title">
                        <ul>
                            <li>分类：</li>
                            {{ range .Cates }}
                                <li class="cat-item"><a
                                        href="/blog/article?cate={{ .ID }}">{{ .Name }}</a>
                                </li>
                            {{ end }}
                        </ul>
                    </div>
                </div>

                <div id="bd" class="wrp clear-fix">
                    <div id="main">
                        {{ if .IsQuery }}
                            <h3 class="obvious-color">搜索结果</h3>
                            {--- load highlight }}
                            {--- for result in page.object_list }}
                              <div class="post">
                                <div class="post-hd">
                                    <h1 class="title">
                                        <a href="{--- result.object.get_absolute_url }}">{--- result.object.title }}</a>
                                    </h1>
                                </div>   
                                <div class="post-bd">
                                    {--- highlight result.object.body with query css_class "highlight_me_please" max_length 200 }}
                                </div>
                              </div>
                            {--- empty }}
                              <div class="post">
                                <p>抱歉，没有搜索到结果，请更换关键词重新搜索~</p>
                              </div>
                            {--- end }}

                            {--- if page.has_previous or page.has_next }}
                                <div>  
                                    {--- if page.has_previous }}
																		  <a class='obvious-color' href="?q={--- query }}&page={--- page.previous_page_number }}">« Previous |</a>
																		{--- endif }}
                                    {--- if page.has_next }}
																		  <a class='obvious-color' href="?q={--- query }}&page={--- page.next_page_number }}">Next »</a>
																		{--- endif }}
                                </div>  
                            {--- endif }}
                        {{ else }}
                            {{ range .Articles }}
                                <div class="post">
                                    <div class="post-hd">
                                        <h1 class="title"><a
                                                href="/blog/article/{{ .ID }}">{{ .Title }}</a></h1>
                                    </div>
                                    <div class="post-bd">
                                        <p>{{.Abstract }}</p>
                                        <p><a href="" class="more-link"></a></p>
                                    </div>
                                    <div class="post-ft">
                                        <a href="/blog/article/{{ .ID }}" class="more">阅读全文>></a>
                                        <i class="icon-date"></i>
                                        <span class="date">{{ .CreatedAt | FormatAsDate }}</span>
                                        <!--i class='icon-praise'></i>-->
                                        <input type='image' class='praise' src="/static/img/gb21.png" href="/blog/article/{{ .ID }}/praise">
                                        <span class='likes_num'>{{ .Likes}}</span>&nbsp;&nbsp;&nbsp;&nbsp;
                                        <a href="/admin/article-edit?id={{ .ID }}">编辑</a>&nbsp;&nbsp;&nbsp;&nbsp;
                                        <span>阅读量:{{ .Views}}</span>
                                    </div>
                                </div>
                            {{ end }}
                            <div id="pagenavi" class="noselect">
                                {{ if gt .Paginator.CurrPage 1}}
                                <a class="previous-page pages" href="?page={{ SubUint64 .Paginator.CurrPage 1 }}">
                                    <span class="icon-previous"></span>上一页
                                </a>
                                {{ end }}

                                {{ if eq .Paginator.FirstPage .Paginator.CurrPage }}
                                <span class="first-page current">1</span>
                                {{ else }}
                                <a href="?page=1" class="first-page">1</a>
                                {{ end }}

                                {{ if gt .Paginator.FirstLeftPage 2 }}
                                <span>...</span>
                                {{ end }}

                                {{ range $index, $page := .Paginator.Pages }}
                                    {{ if eq $page $.Paginator.CurrPage }}
                                    <span class="current">{{ $page }}</span>
                                    {{ else }}
                                    <a class="pages" href="?page={{ $page }}">{{ $page }}</a>
                                    {{ end }}
                                {{ end }}

                                {{ if lt .Paginator.LastRightPage .Paginator.LastPage }}
                                <span>...</span>
                                {{ end }}

                                {{ if ne .Paginator.LastPage 1 }}
                                    {{ if eq .Paginator.LastPage .Paginator.CurrPage }}
                                    <span class="current">{{ .Paginator.LastPage }}</span>
                                    {{ else }}
                                    <a class="pages" href="?page={{ .Paginator.LastPage }}">{{ .Paginator.LastPage }}</a>
                                    {{ end }}
                                {{ end }}

                                {{ if lt .Paginator.CurrPage .Paginator.LastPage }}
                                <a class="next-page pages" href="?page={{ AddUint64 .Paginator.CurrPage 1 }}">
                                    下一页<span class="icon-next"></span>
                                </a>
                                {{ end }}
                            </div>
                        {{ end }}
                    </div>
                </div>
            </div>

            <div class="col-lg-3">
                <!-- tags -->
                <h3 class="obvious-color">标签:</h3>
                <div  id="cloudtag">
                    {{ range .Tags }}
					<a href="/blog/article?tag={{ .ID }}">{{ .Name }}</a>
                    {{ end }}
                </div>

                <!-- archive -->
                <h3 class="obvious-color">文章归档：</h3>
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                    {--- for year,months in date_archive }}
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="heading">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                       href="#collapse"
                                       aria-expanded="true" aria-controls="collapse">
                                        {--- year }} 年
                                    </a>
                                </h4>
                            </div>
                            <div id="collapse" class="panel-collapse collapse in" role="tabpanel"
                                 aria-labelledby="heading">
                                <div class="panel-body">
                                    {--- for month in months }}
                                        <a href="{--- url 'blog:archive' year month }}"><p>{--- month }} 月</p></a>
                                    {--- end }}
                                </div>
                            </div>
                        </div>
                    {--- end }}
                </div>
                <h3 class="obvious-color">热门文章：</h3>
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="heading">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                       href="#collapse"
                                       aria-expanded="true" aria-controls="collapse">
                                    </a>
                                </h4>
                            </div>
                            <div id="collapse" class="panel-collapse collapse in" role="tabpanel"
                                 aria-labelledby="heading">
                                <div class="panel-body">
                                    {--- for article in hot_article }}
                                        <a href="{--- url 'blog:detail' article.id }}"><p>{--- article.title|truncatewords:2 }}</p></a>
                                    {--- end }}
                                </div>
                            </div>
                        </div>
                </div>
                <h3 class="obvious-color">最新评论：</h3>
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="heading">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                       href="#collapse"
                                       aria-expanded="true" aria-controls="collapse">
                                    </a>
                                </h4>
                            </div>
                            <div id="collapse" class="panel-collapse collapse in" role="tabpanel"
                                 aria-labelledby="heading">
                                <div class="panel-body">
                                    {--- for comment in recent_comment }}
                                        <a href="{--- url 'blog:detail' comment.article.id }}"><p>{--- comment.body }}</p></a>
                                    {--- end }}
                                </div>
                            </div>
                        </div>
                </div>
                <h3 class="obvious-color">最近访问</h3>
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="heading">
                                <h4 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                       href="#collapse"
                                       aria-expanded="true" aria-controls="collapse"> 访问量:{{ .VisitorSum }}
                                    </a>
                                </h4>
                            </div>
                            <div id="collapse" class="panel-collapse collapse in" role="tabpanel"
                                 aria-labelledby="heading">
                                <div class="panel-body">
                                    {{ range .Visitors }}
                                        <p>{{ .IP }}[{{ .City }}]  <sup>{{ .CreatedAt | FormatAsDate}}</sup></p>
                                    {{ end }}
                                </div>
                            </div>
                        </div>
                </div>
            </div>
        </div>
    </div>
{{ end }}

{{define "footer"}}
{{ end }}
